# This is a basic workflow to help you get started with Actions

name: Master

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    branches:
      - master
# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Set up JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
    - name: Grant execute permission for gradlew
      run: chmod +x gradlew
    - name: publish code coverage
      uses: paambaati/codeclimate-action@v2.6.0
      env:
          CC_TEST_REPORTER_ID: ${{ secrets.CC_TEST_REPORTER_ID }}
          JACOCO_SOURCE_PATH: "${{github.workspace}}core/src/main/java"
      with:
        # The report file must be there, otherwise Code Climate won't find it
        coverageCommand: make test
        coverageLocations: ${{github.workspace}}core/build/codeclimete/test/jacocoTestReport.xml:jacoco
